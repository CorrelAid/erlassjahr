# Erlassjahr

[![](https://img.shields.io/badge/CorrelAid-project-6fa07f?style=for-the-badge&labelColor=grey&logo=data:image/png;base64,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)](https://github.com/CorrelAid/erlassjahr/)
[![R
badge](https://img.shields.io/badge/Build%20with-â™¥%20and%20R-blue?style=for-the-badge)](https://github.com/dennis-hammerschmidt/badges/)


This repository contains all materials that were used to setup a (semi-)automated workflow and to deploy a ShinyApp that interactively visualizes the annual report data for countreis debt situation by [erlassjahr.de](https://erlassjahr.de).

The goal of [CorrelAid](https://www.correlaid.org) was to help the team of erlassjahr to automate their data generation process and to develop and implement an interactive web application where users can explore the debt situation of countries, complementary to their annual report.

A detailed description of the project, its implementation and the impact can be found in the project description here.

# Run locally
In order to run the app locally, do the following:

1. clone this repository
2. setup R environment 
```
renv::restore()
```
3. Run app
```
runApp('erlassjahr_map/app.R') # german version
runApp('erlassjahr_map/app_en.R') # english version
```

# License information

### Data
[![License: CC BY-SA 4.0](https://img.shields.io/badge/License-CC%20BY--SA%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by-sa/4.0/)

The data is licensed by [Erlassjahr e.V.](https://erlassjahr.de/en) under a
[Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by-sa/4.0). Please see [LICENSE.md](https://github.com/CorrelAid/erlassjahr/blob/master/LICENSE.md) for more detailed information.

### Code 
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

The code is licensed by [CorrelAid e.V.](https://correlaid.org/en) under a MIT License. Please see [LICENSE.md](https://github.com/CorrelAid/erlassjahr/blob/master/LICENSE.md) for more detailed information.



# Repo structure

Below is a (reduced) structure of the repo. 

```
.Rprofile
.gitignore
Anleitung_Update_Karte.docx
Anleitung_zur_Excel_Vorlage.docx
data
   |-- final_data_2019.RData
   |-- final_data_2020.RData
erlassjahr.Rproj
erlassjahr_map
   |-- app.R
   |-- app_en.R
   |-- data
   |   |-- final_data_2020.RData
   |   |-- year_data.Rdata
   |-- map_files
   |   |-- ...
   |-- modules
   |   |-- graphics.R
   |   |-- legends.R
   |-- rsconnect
   |   |-- shinyapps.io
   |   |   |-- erlassjahr
   |   |   |   |-- erlassjahr_map.dcf
   |-- symbols
   |   |-- ...
   |-- www
   |   |-- ...
main.Rmd
renv.lock
renv
   |-- ...
scripts
   |-- data_preparation.R
   |-- functions.R
   |-- template_setup.R
```

There are 4 main components to this repository.

#### `root`

Besides files to setup the Rproject and to make sure that all dependencies are loaded (using [`renv`](https://rstudio.github.io/renv/articles/renv.html)), the root has three important files that detail how to use this repo to setup the automated data generation process and how to publish the ShinyApp (for more details, see the project description here).

- `main.Rmd` is the main file where that executes all scripts to setup an excel template, to process the data and to deploy the ShinyApp. More details can be found in the two .docx files in the root and the project description.
- `Anleitung_zur_Excel_Vorlage.docx` is a description of how to execute the first part of the `main.Rmd` to generate a new Excel file containing the static information from the previous year as well as scraping information from the World Bank API (using the [`WDI`](https://www.r-project.org/nosvn/pandoc/WDI.html) package in R). To allow further comments and fully customization, this file is a .docx
- `Anleitung_Update_Karte.docx` details the second part in the `main.Rmd` and specifies the steps required to automatically categorize states and how to eventually update and deploy the shinyapp. Again, for customization, this file is a .docx.

#### `data`

The data folder contains the final data for all debt years. 

#### `erlassjahr_map`

This folder is used to generate the ShinyApp. There are two app files: `app.R` is for the German version and `app_en.R` for the English version of the map. Both source the same files in the subfolders, i.e., the data, the helper functions in `modules` or any other source files, such as images or shape files for the map.

#### `scripts`

- `data_preparation.R` generates the new Excel file for a given year
- `functions.R` contains helper functions
- `template_setup.R` is the original script that was used to generate the first automated version based on the raw dataset for the debt report in 2020.
